{% extends "base.html" %}
{% block title %}Search form{% endblock %}
{% block content %}
  <div class="container-fluid px-lg-5 my-3">
    <h2>Search</h2>
    <form
      action="/search"
      method="POST">
      <div class="col-sm-6">
        <fieldset class="form-group">
          <legend style="font-size:20px" class="border-bottom mb-4">Genes</legend>
          <!-- This is for gene ids   -->
          <div class="form-group row">
            <label class="col-sm-3 col-form-label" for="gene-id">Gene identifier</label>
              <div class="col-sm-9">
                <input class="form-control is-invalid ui-autocomplete-input" id="gene-id" name="gene-id" placeholder="PBANKA_XXXXXXX" type="text" value="">
                <datalist id="gene-id-list">
                  <option value="PBANKA_1034300"></option>
                  <option value="PBANKA_1231600"></option>
                  <option value="PBANKA_1437500"></option>
                  <option value="PBANKA_1015500"></option>
                  <option value="PBANKA_1319700"></option>
                </datalist>
              </div>
          </div>

          <!-- This is for gene list   -->

          <div class="form-group row">
            <label class="col-sm-3 col-form-label" for="gene-list">Gene identifier(s)</label>
            <div class="col-sm-9">
                <textarea class="form-control is-invalid" id="gene-list" name="gene-list" placeholder="PBANKA_1465921
PBANKA_000050
PBANKA_1466100">{% for gene_id in gene_ids %}{{ gene_id }}
{% endfor %}</textarea>
            </div>
          </div>
        </fieldset>
      </div>
      <div class="form-group">
        <button class="btn btn-primary mb-3">Submit</button>
      </div>
    </form>
  </div>
  {% if error %}
  <div class="container-fluid px-lg-5">
    <div class="alert alert-warning" role="alert">
        {{error}}
    </div>
  </div>
  {% else %}
    {% if output %}
      <hr/>
      <div class="container-fluid px-lg-5">
        <h2>Search results</h2>
        {% for file in files %}
        <a class="btn buttons-csv buttons-html5 btn-success" download="{{ file.name }}" href="{{ file.data }}">Download {{ file.type }}</a>
        {% endfor %}
      </div>
      <div class="container-fluid px-lg-5" id="item-view"></div>
      <script src="https://unpkg.com/mustache@4.2.0/mustache.js"></script>
      <script src="/static/render-items.js"></script>
      <script>
        const items = {% autoescape false %}{{ output }}{% endautoescape %};
        updatePageState()
        window.addEventListener("hashchange", updatePageState)
      </script>
    {% endif %}
  {% endif %}
{% endblock %}